<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plot annotations • cowplot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plot annotations">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cowplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.99</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to cowplot</a>
    </li>
    <li>
      <a href="../articles/plot_annotations.html">Plot annotations</a>
    </li>
    <li>
      <a href="../articles/plot_grid.html">Arranging plots in a grid</a>
    </li>
    <li>
      <a href="../articles/shared_legends.html">Shared legends</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wilkelab/cowplot">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Plot annotations</h1>
                        <h4 class="author">Claus O. Wilke</h4>
            
            <h4 class="date">2018-12-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wilkelab/cowplot/blob/master/vignettes/plot_annotations.Rmd"><code>vignettes/plot_annotations.Rmd</code></a></small>
      <div class="hidden name"><code>plot_annotations.Rmd</code></div>

    </div>

    
    
<p>The cowplot package provides a variety of functions to annotate plots, including annotations underneath the plot, mathematical expressions inside plots, and joint titles for combined plots. Note that as ggplot2 gains more of this functionality natively (e.g. as of version 2.2.0), we recommend to use the ggplot2 methods rather than the cowplot methods. Any functionality that is duplicated between ggplot2 and cowplot may be removed from future versions of cowplot.</p>
<div id="annotations-with-mathematical-expressions" class="section level2">
<h2 class="hasAnchor">
<a href="#annotations-with-mathematical-expressions" class="anchor"></a>Annotations with mathematical expressions</h2>
<p>We commonly want to annotate plots with mathematical expressions, for example when we want to show the result from a statistical test inside the plot. For this purpose, cowplot defines the function <code><a href="../reference/draw_label.html">draw_label()</a></code>, which can add arbitrary test or mathematical expressions to a plot.</p>
<p>Depending on the application, we may want to specify the location of the label either in absolute coordinates (independently of the data plotted) or in coordinates relative to the data shown. Both uses are supported by <code><a href="../reference/draw_label.html">draw_label()</a></code>. For the former, we use <code><a href="../reference/draw_label.html">draw_label()</a></code> in conjunction with <code><a href="../reference/ggdraw.html">ggdraw()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(mpg, disp)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">"blue"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_half_open</a></span>()</a>
<a class="sourceLine" id="cb1-3" title="3">c &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor.test">cor.test</a></span>(mtcars<span class="op">$</span>mpg, mtcars<span class="op">$</span>disp, <span class="dt">method=</span><span class="st">'sp'</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">label &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Spearman "</span>, rho, <span class="st">" = "</span>, estimate, <span class="st">", P = "</span>, pvalue),</a>
<a class="sourceLine" id="cb1-5" title="5">                    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">estimate =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">signif</a></span>(c<span class="op">$</span>estimate, <span class="dv">2</span>), <span class="dt">pvalue =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">signif</a></span>(c<span class="op">$</span>p.value, <span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># adding label via ggdraw, in the ggdraw coordinates</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>(p) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/draw_label.html">draw_label</a></span>(label, <span class="fl">.7</span>, <span class="fl">.9</span>)</a></code></pre></div>
<p><img src="plot_annotations_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
<p>For the latter, we add <code><a href="../reference/draw_label.html">draw_label()</a></code> directly to the plot:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># adding label directly to plot, in the data coordinates</span></a>
<a class="sourceLine" id="cb2-2" title="2">p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/draw_label.html">draw_label</a></span>(label, <span class="dv">20</span>, <span class="dv">400</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="plot_annotations_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
</div>
<div id="joint-plot-titles" class="section level2">
<h2 class="hasAnchor">
<a href="#joint-plot-titles" class="anchor"></a>Joint plot titles</h2>
<p>When we combine plots with <code><a href="../reference/plot_grid.html">plot_grid()</a></code>, we may want to add a title that spans the entire combined figure. While there is no specific function in cowplot to achieve this effect, it can be simulated easily with a few lines of code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># make a plot grid consisting of two panels</span></a>
<a class="sourceLine" id="cb3-2" title="2">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> disp, <span class="dt">y =</span> mpg)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">"blue"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_half_open</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/background_grid.html">background_grid</a></span>(<span class="dt">minor =</span> <span class="st">'none'</span>)</a>
<a class="sourceLine" id="cb3-5" title="5">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> mpg)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">"green"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="st">  </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_half_open</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/background_grid.html">background_grid</a></span>(<span class="dt">minor =</span> <span class="st">'none'</span>)</a>
<a class="sourceLine" id="cb3-8" title="8">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(p1, p2, <span class="dt">labels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'A'</span>, <span class="st">'B'</span>))</a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co"># now add the title</span></a>
<a class="sourceLine" id="cb3-10" title="10">title &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="st">  </span><span class="kw"><a href="../reference/draw_label.html">draw_label</a></span>(<span class="st">"MPG declines with displacement and horsepower"</span>,</a>
<a class="sourceLine" id="cb3-12" title="12">             <span class="dt">fontface =</span> <span class="st">'bold'</span>)</a>
<a class="sourceLine" id="cb3-13" title="13"><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(title, p, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">rel_heights =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.1</span>, <span class="dv">1</span>)) <span class="co"># rel_heights values control title margins</span></a></code></pre></div>
<p><img src="plot_annotations_files/figure-html/unnamed-chunk-4-1.png" width="768"> In the final <code>plot_grid</code> line, the values of <code>rel_heights</code> need to be chosen appropriately so that the margins around the title look correct. With the values chosen here, the title takes up 9% (i.e., 0.1/1.1) of the total plot height.</p>
</div>
<div id="annotations-underneath-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#annotations-underneath-plots" class="anchor"></a>Annotations underneath plots</h2>
<p>The function <code><a href="../reference/add_sub.html">add_sub()</a></code> can be used to add annotation text underneath a plot. This functionality is now mostly superseded by the <code>caption</code> argument to the <code>labs</code> function in base ggplot2, but <code><a href="../reference/add_sub.html">add_sub()</a></code> is retained in cowplot for backwards compatibility. For new plots, I suggest you try <code>caption</code> first and use <code><a href="../reference/add_sub.html">add_sub()</a></code> only when <code>caption</code> doesn’t provide the desired result.</p>
<p>To demonstrate how <code><a href="../reference/add_sub.html">add_sub()</a></code> is used, we first make a plot:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(mpg, disp)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">"blue"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_half_open</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/background_grid.html">background_grid</a></span>(<span class="dt">minor=</span><span class="st">'none'</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">p1</a></code></pre></div>
<p><img src="plot_annotations_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
<p>Now we add an annotation underneath:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/add_sub.html">add_sub</a></span>(p1, <span class="st">"This is an annotation.</span><span class="ch">\n</span><span class="st">Annotations can span multiple lines."</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>(p2)</a></code></pre></div>
<p><img src="plot_annotations_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<p>Note that <code>p2</code> is not a ggplot object but a gtable. It needs to be drawn with <code><a href="../reference/ggdraw.html">ggdraw()</a></code>.</p>
<p>We can also do this repeatedly, and we can use mathematical expressions instead of plain text.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/add_sub.html">add_sub</a></span>(p1, <span class="st">"This formula has no relevance here:"</span>, <span class="dt">y  =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">p3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/add_sub.html">add_sub</a></span>(p2, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(a<span class="op">^</span><span class="dv">2</span><span class="op">+</span>b<span class="op">^</span><span class="dv">2</span>, <span class="st">" = "</span>, c<span class="op">^</span><span class="dv">2</span>)), <span class="dt">size =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>(p3)</a></code></pre></div>
<p><img src="plot_annotations_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
<p>This code also works with faceted plots:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">plot.iris &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Sepal.Length, Sepal.Width)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Species) <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_half_open</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/background_grid.html">background_grid</a></span>(<span class="dt">major =</span> <span class="st">'y'</span>, <span class="dt">minor =</span> <span class="st">"none"</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add thin horizontal lines</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">  </span><span class="kw"><a href="../reference/panel_border.html">panel_border</a></span>() <span class="co"># and a border around each panel</span></a>
<a class="sourceLine" id="cb7-6" title="6">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/add_sub.html">add_sub</a></span>(plot.iris, <span class="st">"Annotation underneath a faceted plot, left justified."</span>, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">hjust =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>(p2)</a></code></pre></div>
<p><img src="plot_annotations_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Finally, it is possible to move the annotation inside of the plot if desired. Note that the coordinate <code>x</code> is measured relative to the left border of the plot panel but the coordinate <code>y</code> is measured relative to the space that has been added underneath the plot. Neither <code>x</code> nor <code>y</code> are measured in the units of the data plotted. This guarantees that the annotation can be placed in the same location in different plots, regardless of the data shown.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>(<span class="kw"><a href="../reference/add_sub.html">add_sub</a></span>(p1, <span class="st">"Annotation inside plot"</span>, <span class="dt">vpadding=</span>grid<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/grid/topics/unit">unit</a></span>(<span class="dv">0</span>, <span class="st">"lines"</span>),</a>
<a class="sourceLine" id="cb8-2" title="2">       <span class="dt">y =</span> <span class="dv">6</span>, <span class="dt">x =</span> <span class="fl">0.03</span>, <span class="dt">hjust =</span> <span class="dv">0</span>))</a></code></pre></div>
<p><img src="plot_annotations_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#annotations-with-mathematical-expressions">Annotations with mathematical expressions</a></li>
      <li><a href="#joint-plot-titles">Joint plot titles</a></li>
      <li><a href="#annotations-underneath-plots">Annotations underneath plots</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Claus O. Wilke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
