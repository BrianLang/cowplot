<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to cowplot • cowplot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to cowplot">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cowplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.99</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to cowplot</a>
    </li>
    <li>
      <a href="../articles/plot_annotations.html">Plot annotations</a>
    </li>
    <li>
      <a href="../articles/plot_grid.html">Arranging plots in a grid</a>
    </li>
    <li>
      <a href="../articles/shared_legends.html">Shared legends</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wilkelab/cowplot">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to cowplot</h1>
                        <h4 class="author">Claus O. Wilke</h4>
            
            <h4 class="date">2018-12-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wilkelab/cowplot/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p>The cowplot package is a simple add-on to ggplot. It is meant to provide a publication-ready theme for ggplot, one that requires a minimum amount of fiddling with sizes of axis labels, plot backgrounds, etc. Its primary purpose is to give my students and postdocs an easy way to make figures that I will approve of. Thus, this package meets my personal needs and tastes. Yours may be different.</p>
<p>In addition to providing a modified plot theme, this package also offers functionality for custom annotations to ggplot plots. It turns out that the easiest way to offer this functionality was to implement a general-purpose drawing canvas on top of ggplot. As a result, you can achieve quite unusual effects with this package (see more below).</p>
<p>The cowplot source code is available on github: <a href="https://github.com/wilkelab/cowplot">https://github.com/wilkelab/cowplot</a></p>
<div id="plot-design" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-design" class="anchor"></a>Plot design</h1>
<p>I don’t find the default ggplot design particularly elegant. In particular, I don’t like the gray background grid. I feel it often distracts from the data. For example, see this ggplot visualization of the <code>mpg</code> data set:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mpg, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy, <span class="dt">colour =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(cyl))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="st">   </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="fl">2.5</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>I prefer a clean and sparse layout for publication. I also prefer the approach of building a graph by adding elements rather than taking them away. Therefore, the default design of cowplot has no grid at all. It looks similar to ggplot’s <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic()</a></code>, but there are a few important but subtle differences, mostly with respect to font sizes.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cowplot)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mpg, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy, <span class="dt">colour =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(cyl))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">   </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_cowplot</a></span>()</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p><strong>Note: As of version 1.0, the cowplot package does not modify the default ggplot2 theme anymore. To recover the old behavior of a modified default theme, add <code><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set(theme_cowplot())</a></code> to the beginning of your code, right after loading the cowplot package.</strong></p>
<p>The cowplot default theme works nicely in conjunction with the <code><a href="../reference/save_plot.html">save_plot()</a></code> function the package provides, such that the output pdfs are nicely formatted and scaled and don’t require any additional parameter fiddling:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">plot.mpg &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mpg, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy, <span class="dt">colour =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(cyl))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size=</span><span class="fl">2.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_cowplot</a></span>()</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co"># use save_plot() instead of ggsave() when using cowplot for improved defaults</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw"><a href="../reference/save_plot.html">save_plot</a></span>(<span class="st">"mpg.png"</span>, plot.mpg)</a></code></pre></div>
<p>The resulting figure:</p>
<p><img src="introduction_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>By default, cowplot disables grid lines on the plot. In many cases, this is the cleanest and most elegant way to display the data. However, sometimes gridlines may be useful, and thus cowplot provides a simple way of adding gridlines, via the function <code><a href="../reference/background_grid.html">background_grid()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">plot.mpg <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/background_grid.html">background_grid</a></span>(<span class="dt">major =</span> <span class="st">"xy"</span>, <span class="dt">minor =</span> <span class="st">"none"</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>While the same result could be obtained using the function <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code>, the function <code><a href="../reference/background_grid.html">background_grid()</a></code> makes the most commonly used option easily accessible. See the reference documentation for details.</p>
<p>There are a few other themes that cowplot defines, including a minimal grid theme, a theme with only horizontal and only vertical grid lines, and a theme without any grids or axes. All themes are coordinated so they work well with each other and with <code><a href="../reference/save_plot.html">save_plot()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(</a>
<a class="sourceLine" id="cb5-2" title="2">  plot.mpg <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/theme_minimal_grid.html">theme_minimal_grid</a></span>(<span class="dv">12</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"theme_minimal_grid()"</span>),</a>
<a class="sourceLine" id="cb5-3" title="3">  plot.mpg <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/theme_minimal_grid.html">theme_minimal_hgrid</a></span>(<span class="dv">12</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"theme_minimal_hgrid()"</span>),</a>
<a class="sourceLine" id="cb5-4" title="4">  plot.mpg <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/theme_minimal_grid.html">theme_minimal_vgrid</a></span>(<span class="dv">12</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"theme_minimal_vgrid()"</span>),</a>
<a class="sourceLine" id="cb5-5" title="5">  plot.mpg <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/theme_map.html">theme_map</a></span>(<span class="dv">12</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"theme_map()"</span>), <span class="dt">align =</span> <span class="st">"hv"</span></a>
<a class="sourceLine" id="cb5-6" title="6">)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-6-1.png" width="816"></p>
</div>
<div id="arranging-graphs-into-a-grid" class="section level1">
<h1 class="hasAnchor">
<a href="#arranging-graphs-into-a-grid" class="anchor"></a>Arranging graphs into a grid</h1>
<p>One limitation of ggplot is that it doesn’t make it easy to add labels and other annotations to a plot. ggplot strictly separates the <em>plot panel</em> (the part inside the axes) from the rest of the plot, and while it’s generally straightforward to modify one or the other we cannot easily change both. To solve this issue in a generic way, cowplot implements a generic drawing layer on top of ggplot. In this drawing layer, you can add arbitrary graphical elements on top of a graph. This concept will be discussed in detail in the next section. For now, let’s discuss how this capability allows us to make nice compound plots.</p>
<p>The need for compound plots arises frequently when writing scientific publications. For example, let’s assume we have created the following two plots, and we would like to combine them into a two-part figure with parts A and B. In our case, the plots are the following:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">plot.mpg &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mpg, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy, <span class="dt">colour =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(cyl))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size=</span><span class="fl">2.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_cowplot</a></span>()</a>
<a class="sourceLine" id="cb6-3" title="3">plot.mpg</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">plot.diamonds &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(diamonds, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(clarity, <span class="dt">fill =</span> cut)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">   </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_cowplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">angle=</span><span class="dv">70</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>, <span class="dt">hjust =</span> <span class="fl">0.9</span>))</a>
<a class="sourceLine" id="cb7-3" title="3">plot.diamonds</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-7-2.png" width="480"></p>
<p>cowplot allows us to combine them into one graph via the function <code><a href="../reference/plot_grid.html">plot_grid()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(plot.mpg, plot.diamonds, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>))</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>By default, the plots are simply placed into the grid as they are, and so the axes are not aligned. If axis alignment is required, it can be switched on via the <code>align</code> option:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(plot.mpg, plot.diamonds, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="dt">align =</span> <span class="st">"h"</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p>The function <code><a href="../reference/plot_grid.html">plot_grid()</a></code> will attempt to achieve a reasonable layout of the plots provided. However, you can precisely manipulate the layout by specifying the number of rows or columns or both:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(plot.mpg, <span class="ot">NULL</span>, <span class="ot">NULL</span>, plot.diamonds, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(plot.mpg, plot.diamonds, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">align =</span> <span class="st">"v"</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-11-1.png" width="384"></p>
<p>The function <code><a href="../reference/plot_grid.html">plot_grid()</a></code> works nicely in combination with the function <code><a href="../reference/save_plot.html">save_plot()</a></code>, which can be told about the grid layout. For example, if we want to save a 2-by-2 figure, we might use this code:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">plot2by2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(plot.mpg, <span class="ot">NULL</span>, <span class="ot">NULL</span>, plot.diamonds,</a>
<a class="sourceLine" id="cb12-2" title="2">                      <span class="dt">labels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw"><a href="../reference/save_plot.html">save_plot</a></span>(</a>
<a class="sourceLine" id="cb12-4" title="4">  <span class="st">"plot2by2.png"</span>, plot2by2,</a>
<a class="sourceLine" id="cb12-5" title="5">  <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="co"># we're saving a grid plot of 2 columns</span></a>
<a class="sourceLine" id="cb12-6" title="6">  <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="co"># and 2 rows</span></a>
<a class="sourceLine" id="cb12-7" title="7">  <span class="dt">base_asp =</span> <span class="fl">1.35</span> <span class="co"># aspect ratio of 1.35 for individual figures in the grid </span></a>
<a class="sourceLine" id="cb12-8" title="8">)</a></code></pre></div>
<p>The resulting figure: <img src="introduction_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<p>The advantage of saving figures in this way is that you can first develop the code for individual figures, and once each individual figure looks the way you want it to you can easily combine the figures into a grid. <code><a href="../reference/save_plot.html">save_plot()</a></code> will make sure to scale the overall figure size such that the individual figures look the way they do when saved individually (as long as they all have the same aspect ratio).</p>
</div>
<div id="generic-plot-annotations" class="section level1">
<h1 class="hasAnchor">
<a href="#generic-plot-annotations" class="anchor"></a>Generic plot annotations</h1>
<p>Finally, let’s discuss how we can use cowplot to create more unusual plot designs. For example, let’s take the mpg image from the previous section, label it with an A in the top-left corner, and mark it as a draft:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>(plot.mpg) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/draw_plot_label.html">draw_plot_label</a></span>(<span class="st">"A"</span>, <span class="dt">size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/draw_label.html">draw_label</a></span>(<span class="st">"DRAFT!"</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">size =</span> <span class="dv">80</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The function <code><a href="../reference/ggdraw.html">ggdraw()</a></code> sets up the drawing layer, and functions that are meant to operate on this drawing layer all start with <code>draw_</code>. The resulting object is again a standard ggplot object, and you can do with it whatever you might do with a regular ggplot plot, such as save it with <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>. [However, as mentioned before, I recommend using <code><a href="../reference/save_plot.html">save_plot()</a></code> instead.]</p>
<p>In fact, because <code><a href="../reference/ggdraw.html">ggdraw()</a></code> produces a standard ggplot object, we can draw on it with standard geoms if we want to. For example:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">t &lt;-<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1000</span>)<span class="op">/</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb14-2" title="2">spiral &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="fl">.45+.55</span><span class="op">*</span>t<span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cos</a></span>(t<span class="op">*</span><span class="dv">15</span>), <span class="dt">y =</span> <span class="fl">.55-.55</span><span class="op">*</span>t<span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(t<span class="op">*</span><span class="dv">15</span>), t)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>(plot.mpg) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="dt">data =</span> spiral, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">colour =</span> t), <span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">.4</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>I don’t know if this is useful in any way, but it shows the power of the approach.</p>
<p>Importantly, though, in all cases discussed so far, the main plot was below all other elements. Sometimes, you might want the plot on top. In this case, you can initialize an empty drawing canvas by calling <code><a href="../reference/ggdraw.html">ggdraw()</a></code> without any parameters. You then place the plot by calling <code><a href="../reference/draw_plot.html">draw_plot()</a></code>. Notice the difference in the two plots produced by the following code:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">boxes &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>((<span class="dv">0</span><span class="op">:</span><span class="dv">33</span>)<span class="op">/</span><span class="dv">40</span>, <span class="dv">40</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb15-3" title="3">  <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>((<span class="dv">0</span><span class="op">:</span><span class="dv">33</span>)<span class="op">/</span><span class="dv">40</span>, <span class="dv">40</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">)</a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co"># plot on top of annotations</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="dt">data =</span> boxes, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">xmin =</span> x, <span class="dt">xmax =</span> x <span class="op">+</span><span class="st"> </span><span class="fl">.15</span>, <span class="dt">ymin =</span> y, <span class="dt">ymax =</span> y <span class="op">+</span><span class="st"> </span><span class="fl">.15</span>),</a>
<a class="sourceLine" id="cb15-8" title="8">            <span class="dt">colour =</span> <span class="st">"gray60"</span>, <span class="dt">fill =</span> <span class="st">"gray80"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/draw_plot.html">draw_plot</a></span>(plot.mpg) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="st">  </span><span class="kw"><a href="../reference/draw_label.html">draw_label</a></span>(<span class="st">"Plot is on top of the grey boxes"</span>, <span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb15-11" title="11">            <span class="dt">vjust =</span> <span class="dv">1</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">fontface =</span> <span class="st">'bold'</span>)</a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co"># plot below annotations</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>(plot.mpg) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="dt">data =</span> boxes, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">xmin =</span> x, <span class="dt">xmax =</span> x <span class="op">+</span><span class="st"> </span><span class="fl">.15</span>, <span class="dt">ymin =</span> y, <span class="dt">ymax =</span> y <span class="op">+</span><span class="st"> </span><span class="fl">.15</span>),</a>
<a class="sourceLine" id="cb15-15" title="15">            <span class="dt">colour =</span> <span class="st">"gray60"</span>, <span class="dt">fill =</span> <span class="st">"gray80"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="st">  </span><span class="kw"><a href="../reference/draw_label.html">draw_label</a></span>(<span class="st">"Plot is underneath the grey boxes"</span>, <span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb15-17" title="17">            <span class="dt">vjust =</span> <span class="dv">1</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">fontface =</span> <span class="st">'bold'</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-16-1.png" width="700"><img src="introduction_files/figure-html/unnamed-chunk-16-2.png" width="700"></p>
<p>Note that placing a plot on top of annotations only makes sense if the plot background is transparent. This is one of the main differences between <code><a href="../reference/theme_cowplot.html">theme_cowplot()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic()</a></code>. If you tried the same example with <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic()</a></code>, the gray boxes underneath the plot would not show.</p>
<p>The <code><a href="../reference/draw_plot.html">draw_plot()</a></code> function also allows us to place graphs at arbitrary locations and at arbitrary sizes onto the canvas. This is useful for combining subplots into a layout that is not a simple grid, e.g. with an inset plotted inside a larger graph.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># plot.mpg and plot.diamonds were defined earlier</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/draw_plot.html">draw_plot</a></span>(</a>
<a class="sourceLine" id="cb16-4" title="4">    plot.diamonds <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.justification =</span> <span class="st">"bottom"</span>),</a>
<a class="sourceLine" id="cb16-5" title="5">    <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span></a>
<a class="sourceLine" id="cb16-6" title="6">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="st">  </span><span class="kw"><a href="../reference/draw_plot.html">draw_plot</a></span>(</a>
<a class="sourceLine" id="cb16-8" title="8">    plot.mpg <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.justification =</span> <span class="st">"top"</span>, <span class="dt">plot.background =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(<span class="dt">fill =</span> <span class="st">"white"</span>)),</a>
<a class="sourceLine" id="cb16-10" title="10">    <span class="fl">0.5</span>, <span class="fl">0.54</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span></a>
<a class="sourceLine" id="cb16-11" title="11">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="st">  </span><span class="kw"><a href="../reference/draw_plot_label.html">draw_plot_label</a></span>(</a>
<a class="sourceLine" id="cb16-13" title="13">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</a>
<a class="sourceLine" id="cb16-14" title="14">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb16-15" title="15">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="fl">0.94</span>),</a>
<a class="sourceLine" id="cb16-16" title="16">    <span class="dt">size =</span> <span class="dv">15</span></a>
<a class="sourceLine" id="cb16-17" title="17">  )</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<p>We can also combine plots and images, using the function <code><a href="../reference/draw_image.html">draw_image()</a></code>. This function, which requires the <strong>magick</strong> package to be installed, can take images in many different formats and combine them with ggplot plots. For example, we can use an image as a plot background:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">p &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(iris, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">fill =</span> Species)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/theme_cowplot.html">theme_cowplot</a></span>()</a>
<a class="sourceLine" id="cb17-5" title="5"><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="st">  </span><span class="kw"><a href="../reference/draw_image.html">draw_image</a></span>(<span class="st">"http://jeroen.github.io/images/tiger.svg"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="st">  </span><span class="kw"><a href="../reference/draw_plot.html">draw_plot</a></span>(p)</a></code></pre></div>
<pre><code>## Warning: ImageMagick was built without librsvg which causes poor qualty of SVG rendering.
## For better results use image_read_svg() which uses the rsvg package.</code></pre>
<p><img src="introduction_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>We can also make a plot grid with a regular plot and an image:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ggdraw.html">ggdraw</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/draw_image.html">draw_image</a></span>(<span class="st">"http://jeroen.github.io/images/tiger.svg"</span>, <span class="dt">scale =</span> <span class="fl">0.9</span>)</a></code></pre></div>
<pre><code>## Warning: ImageMagick was built without librsvg which causes poor qualty of SVG rendering.
## For better results use image_read_svg() which uses the rsvg package.</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="../reference/plot_grid.html">plot_grid</a></span>(p, p2, <span class="dt">labels =</span> <span class="st">"AUTO"</span>)</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#plot-design">Plot design</a></li>
      <li><a href="#arranging-graphs-into-a-grid">Arranging graphs into a grid</a></li>
      <li><a href="#generic-plot-annotations">Generic plot annotations</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Claus O. Wilke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
